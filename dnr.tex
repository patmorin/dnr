\documentclass{patmorin}
\listfiles
\usepackage{pat}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{mathtools}
\usepackage{thmtools}
\usepackage{thm-restate}
% \usepackage{dingbat}
% \usepackage{todonotes}
% \usepackage{comment}

\usepackage[inline]{enumitem}
\newlist{tightenum}{enumerate}{2}
\setlist[tightenum,1]{noitemsep,nosep,
                        label=\rm(\alph*),
                        ref  =\alph*}
\setlist[tightenum,2]{noitemsep,nosep,
                         label=\rm(\roman*),
                         ref  =\roman*}

\newenvironment{dummy}{}
% david proposes the following additions
% \renewcommand{\ge}{\geqslant}
% \renewcommand{\le}{\leqslant}
% \renewcommand{\geq}{\geqslant}
% \renewcommand{\leq}{\leqslant}

\newcommand{\vida}[1]{{\color{DarkGreen} Vida: #1}}
\newcommand{\pat}[1]{\textcolor{Blue}{[Pat: #1]}}
\newcommand{\gwen}[1]{\textcolor{Purple}{Gwen: #1}}
\newcommand{\piotr}[1]{\textcolor{red}{Piotr: #1}}

% \numberwithin{equation}{lem}

\crefname{p}{}{}
\creflabelformat{p}{#2(#1)#3}

\usepackage{todonotes}
\newenvironment{clmproof}{\begin{proof}[Proof of Claim:]\renewcommand{\qedsymbol}{\rule{1ex}{1ex}}}{\end{proof}}

\usepackage[longnamesfirst,numbers,sort&compress]{natbib}

% \newcommand{\mathdefin}[1]{\color{brightmaroon}#1}}
\setlength{\parskip}{1ex}

% Document-specific commands and math operators
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\sep}{sn}
\DeclareMathOperator{\tw}{tw}
\DeclareMathOperator{\pw}{pw}
\DeclareMathOperator{\bw}{bw}
\DeclareMathOperator{\td}{td}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\radius}{radius}
\DeclareMathOperator{\pth}{path}
\DeclareMathOperator{\mindist}{min-dist}
\DeclareMathOperator{\mindeg}{min-deg}
\DeclareMathOperator{\girth}{girth}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\ld}{ld}
\DeclareMathOperator{\polylog}{polylog}
\DeclareMathOperator{\evol}{Evol}
\DeclareMathOperator{\ivol}{Ivol}
\DeclareMathOperator{\tvol}{Tvol}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\GG}{\mathcal{G}}
\newcommand{\Oh}{\mathcal{O}}
\DeclareMathOperator{\thick}{th}

\DeclarePairedDelimiter\set{\{}{\}}

\title{\MakeUppercase{Dvo\v{r}Ã¡k-Norin Revisited}}

\author{Hussein Houdrouge, Bobby Miraftab, and Pat Morin}

\date{}



\begin{document}

\maketitle

\begin{abstract}
  We give a constructive proof of the fact that the treewidth of a graph $G$ is bounded by a linear function of the separation number of $G$.
\end{abstract}


\section{Introduction}

In this paper every graph $G$ is undirected simple with vertex set $V(G)$ and edge set $E(G)$.  A \defin{separation} $(A,B)$ of a graph $G$ is a pair of subsets of $V(G)$ with $A\cup B= V(G)$ and such that, for each edge $vw$ of $G$, $\{v,w\}\subseteq A$ or $\{v,w\}\subseteq B$.  The \defin{order} of a separation $(A,B)$ is $|A\cap B|$.  A separation $(A,B)$ is \defin{balanced} if $|A\setminus B|\le \tfrac{2}{3}|V(G)|$ and $|B\setminus A|\le \tfrac{2}{3}|V(G)$.  The \defin{separation number} $\mathdefin{\sep(G)}$ of a graph $G$ is the minimum integer $a$ such that every subgraph of $G$ has a balanced separation of order at most $a$.

We reprove the following result of \citet{dvorak.norin:treewidth}
\begin{thm}
  For every graph $G$, $\tw(G)\le 15\sep(G)$.
\end{thm}



\section{Preliminaries}


A \defin{flow} $(f,g)$ in a graph $G$ is a pair of functions $f:V(G)^2\to\R_{\ge 0}$ and $g:V(G)\to\R_{\ge 0}$ such that $f(v,w)=0$ for each $vw\not\in E(G)$ and
\begin{equation}
  \sum_{w\in N_G(v)} f(v,w) + g(v) \ge \sum_{w\in N_G(v)} f(w,v)
  \label{conservation_of_flow}
\end{equation}
Any vertex $v\in V(G)$ in which \cref{conservation_of_flow} does not hold with equality is called a \defin{sink}.  The \defin{congestion} of $\mathcal{F}$ at a vertex $v\in V(G)$ the quantity on the left-hand-side of \eqref{conservation_of_flow}.  The \defin{congestion} of $\mathcal{F}$ is the maximum congestion of $\mathcal{F}$ at any vertex in $G$.  Without loss of generality we consider only flows in which at least one of $f(v,w)$ or $f(w,v)$ is zero for each edge $vw\in E(G)$.  (Otherwise, we can consider the modified flow $(f',g)$ where $f'(v,w)=f(v,w)-\min\{f(v,w),f(w,v)\}$ for each $vw\in E(G)$.)  The \defin{total supply} of $\mathcal{F}$ is $\sum_{v\in V(G)} g(v)$.


For a graph $G$ and a subset $W\subseteq V(G)$, a \defin{$W$-cloud} of $G$ is a flow $\mathcal{F}:=(f,g)$ in which $g(v)\le 1$ for each $v\in V(G)$ and the only sinks of $\mathcal{F}$ are the vertices in $W$.  \citet{dvorak.norin:treewidth} make the following observation:

\begin{obs}\label{flow_vs_cut}
  For any graph $G$ and any $W\subseteq V(G)$, there exists a $W$-cloud of $G$ with total supply $s$ and congestion at most $\alpha$ if and only if there is no separation $(X,Y)$ of $G$ with $W\subseteq Y$ such that $|Y\setminus X| + \alpha|X\cap Y| < s$.
\end{obs}

We will use \cref{flow_vs_cut} with $s:=n:=|V(G)|$.  In this setting,
$|Y\setminus X|=n-|X|$. Thus, the condition $|Y\setminus X|+\alpha|X\cap Y|<s$ becomes $n-|X|+\alpha|X\cap Y|< n$.  Rewriting this inequality yields the following special case of \cref{flow_vs_cut}:

\begin{obs}\label{flow_vs_cut_n}
  For any $n$-vertex graph $G$ and any $W\subseteq V(G)$, there exists a $W$-cloud of $G$ with total supply $n$ and congestion at most $\alpha$ if and only if there is no separation $(X,Y)$ of $G$ with $W\subseteq Y$ such that $|X|/|Y\setminus X| > \alpha$.
\end{obs}

\section{The Proof}

[TODO: I didn't work out the constants. Think of something like ${C}=100$ and ${c}=10$]

\begin{lem}\label{balanced_on_w}
  Let
  $n\ge {C}/{c}$, let $G$ be an $n$-vertex graph, let $W\subseteq V(G)$, let $(A,B)$ be a balanced separation of $G$ of order $a$, and let $\mathcal{F}$ be a $W$-cloud of $G$ with total supply $n$ and congestion at most $\alpha:=n/(\beta|W|)$.  Then
  \[
  \max\{|A\cap W|,|B\cap W|\}\le \left(1-\tfrac{\beta}{3}\right)|W|+2a \enspace .
  \]
\end{lem}

\begin{proof}
  \ [TODO: This proof uses some old notation. Update.]
  Let $(f,g):=\mathcal{F}$.  Since the total supply of $\mathcal{F}$ is $n$, $g(v)=1$ for each $v\in V(G)$.  We construct a flow $\mathcal{F}':=(f',g')$  from $\mathcal{F}$ by preventing any flow from entering or leaving vertices in $A\cap B$.  More precisely, $g'(v):=0$, $f'(v,w):=0$, and $f'(w,v):=0$ for each $v\in A\cap B$ and each $w\in N_G(v)$.  [TODO: Explain how to reduce flow on other edges and and supply on other vertices.]   Since each vertex in $A\cap B$ has congestion at most $\alpha$, the flow $\mathcal{F}'$ has total supply at least $n-\alpha|A\cap B|$.  Since $g'(v)\le g(v)$ for all for $v\in V(G)$, this implies that, for any $S\subseteq V(G)$, $\sum_{v\in S} g'(v)\ge \sum_{v\in S}g(v) - \alpha|A\cap B|\ge |S| - \alpha a$.

  Consider the graph $G_A:=G-B$.  Since $f'(v,w)=0$ for any edge $vw$ of $G$ with an endpoint in $A\cap B$, the $W$-cloud $\mathcal{F}'$ of $G$ induces a $(W-B)$ cloud $\mathcal{F}'_A$ in $G_A$.  The total supply of $\mathcal{F}'_A$ is
  \[
     \sum_{v\in V(G_A)} g'(v) \ge |A\setminus B| -\alpha a \ge \left(\frac{n}{3}-a\right) - \frac{{c}n}{C} = \left(\frac{C-c}{3C}\right)n - a = \left(\frac{1}{3}-\frac{c}{C}-\frac{a}{n}\right)n
     = \left(\frac{1-\epsilon}{3}\right)n
  \]

  Since the congestion of $\mathcal{F}'$ is at most $\alpha$, the congestion of $\mathcal{F}'_A$ is at most $\alpha$.  In particular, the congestion at each vertex of $V(G_A)\cap W$ is at most $\alpha$.  Therefore,
  \[
     \alpha \ge \frac{\sum_{v\in V(G_A)} g'(v)}{|V(G_A)\cap W|}
     \ge \frac{(1-\epsilon)n}{3|V(G_A)\cap W|}
  \]
  Rewriting this inequality yields
  \begin{align*}
    |V(G_A)\cap W|
    & \ge \frac{(1-\epsilon)n}{3\alpha}\\
    & = \frac{(1-\epsilon)nCa}{3cn}\\
    & = \left(\frac{1-\epsilon}{3c}\right) Ca
    % & = (\tfrac{1}{3}-\epsilon)n\cdot \frac{Ca}{cn} \\
    % & = (\tfrac{1}{3}-\epsilon)Ca/c \\
    % & = (\tfrac{1}{3c}-\tfrac{\epsilon}{c})Ca
    % \ge \frac{(1-3{c}/{C})n}{3{c}n/{C}a} - \frac{C}{{c}n}
    % \ge \frac{(1-3{c}/{C})Ca}{3{c}} - 1
  \end{align*}
  Then, since $B=V(G)\setminus V(G_A)$, we have
  \begin{align*}
    |B\cap W|
      & = |(V(G)\cap W)\setminus(V(G_A)\cap W)| \\
      & = |W\setminus(V(G_A)\cap W)| \\
      & = |W|-(V(G_A)\cap W)| \\
      & \le |W|-\left(\frac{1-\epsilon}{3c}\right)Ca \\
      & = \left(1-\frac{1-\epsilon}{3c}\right)Ca \qedhere
  \end{align*}
\end{proof}

\begin{lem}
  Let $a\ge 1$, let $G$ be a graph with $\sep(G)\le a$, let $W\subseteq V(G)$, and let $(X,Y)$ be a separation of $G$ such that $W\subseteq Y$ and $|X|/|X\cap Y| > n/(\beta|W|)$.  Then there exists a separation $(A,B)$ of $G$ of order at most $\beta|W|+a$ such that
  \[
  \max\{|A\cap W|,|B\cap W|\}\le \left(1-\tfrac{\beta}{3}+\tfrac{\beta^2}{3}\right)|W| \enspace .
  \]
\end{lem}

\begin{proof}
  Among all separations $(X,Y)$ that satisfy the conditions of the lemma, choose one that minimizes $|Y|$. Create a new $n$-vertex graph $G'\supseteq G[Y\setminus X]$ by adding $|X|$ degree-1 vertices to $G[Y\setminus X]$ adjacent to the vertices in $N_G(X)$, and distributed as equally as possible.

  Observe that $|N_G(X)|\ge |X|(\beta|W|/n)$ since, otherwise the separation $(N_G[X],Y\setminus(X\cap Y))$ is a separation that satisfies the conditions of the lemma and contradicts the minimality of $Y$ in the choice of $(X,Y)$.  Therefore, each vertex in $N_G(X)$ has at most $n/(\beta|W|)$ neighbours in $V(G')\setminus (Y\setminus X)$.\todo{Watch out for floors and ceilings.}

  We claim that $G'$ has a $(W\setminus X)$-cloud with total supply $n$ and congestion at most $n/(\beta|W|)$.  By \cref{flow_vs_cut_n}, it suffices to show that $G'$ has no separation $(X',Y')$ with $W\subseteq Y'$ and $|X'|/|X'\cap Y'|>n/(\beta|W|)$.  Assume for the sake of contradiction that such a separation exists.  Let $X'':=X\cup X'\cap V(G)$.  Form the set $Y''$ from the set $Y'\cup W$ by replacing each vertex $v$ in $V(G')\setminus (Y\setminus X)$ with the unique neighbour of $v$ in $N_G(X)$.  We claim that $(X'',Y'')$ is a separation of $G$ with $W\subseteq Y''$ and such that $|X''|/|X''\cap Y''|\ge |X'|/|X'\cap Y'|$.  This is not possible, since it would contradicting the minimality of $Y$ in the choice of $(X,Y)$.

  We now prove this claim......

  Thus $G'$ has a $(W\setminus X)$-cloud with total supply $n$ and congestion at most $n/(\beta|W|)$.  Let $(A',B')$ be a balanced separation of $G[X\setminus Y]$ of order at most $a$.  For each vertex $v\in V(G')\setminus V(G)$, add $v$ to $A'$ if the unique neighbour of $v$ is in $A'$, otherwise add $v$ to $B'$.  This gives separation of $G'$ whose order is at most $a$.  By \cref{balanced_on_w}, $|A'\cap W\setminus X|\le (1-\tfrac{\beta}{3})|W\setminus X|+2a$ and $|B'\cap W\setminus X|\le (1-\tfrac{\beta}{3})|W\setminus X|+2a$.

  Finally, let $A:=X\cup A'\cap V(G)$ and let $B:=(X\cap Y)\cup B'\cap V(G)$.  Then $(A,B)$ is a separation of $G$ with
  \[
    |A\cap B|\le |X\cap Y|+|A'\cap B'| \le \beta|W| + a
  \]
  Furthermore,
  \begin{align*}
    |A\cap W| & \le |X\cap W|+(1-\tfrac{\beta}{3})|W\setminus X| \\
       & = |X\cap W|+(1-\tfrac{\beta}{3})(|W|-|W\cap X|) \\
       & = \tfrac{\beta}{3}|X\cap W|+(1-\tfrac{\beta}{3})|W| \\
       & \le \tfrac{\beta^2}{3}|W|+(1-\tfrac{\beta}{3})|W| \\
       & = (1-\tfrac{\beta}{3}+\tfrac{\beta^2}{3})|W|
  \end{align*}
\end{proof}



\bibliographystyle{plainurlnat}
\bibliography{dnr}


\end{document}
